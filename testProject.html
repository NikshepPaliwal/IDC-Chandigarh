<!DOCTYPE html>
<html>
  <head>
    <title>Simple VR Battleground</title>
    <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>
  </head>

  <body>
    <a-scene>

      <!-- SKY -->
      <a-sky color="#87CEEB"></a-sky>

      <!-- GROUND -->
      <a-plane 
        position="0 0 -5" 
        rotation="-90 0 0" 
        width="40" 
        height="40" 
        color="#7CFC00">
      </a-plane>

      <!-- TITLE -->
      <a-text 
        value="VR Army Battleground" 
        position="-1.5 3 -4" 
        color="black" 
        width="6">
      </a-text>

      <!-- BUNKERS -->
      <a-box position="-3 1 -10" depth="3" height="2" width="4" color="#8B4513"></a-box>
      <a-box position="3 1 -10" depth="3" height="2" width="4" color="#8B4513"></a-box>

      <!-- ENEMY TARGETS -->
      <a-cylinder 
        class="enemy"
        position="-2 1 -6" 
        radius="0.5" 
        height="2" 
        color="red">
      </a-cylinder>

      <a-cylinder 
        class="enemy"
        position="2 1 -8" 
        radius="0.5" 
        height="2" 
        color="red">
      </a-cylinder>

      <a-cylinder 
        class="enemy"
        position="0 1 -12" 
        radius="0.5" 
        height="2" 
        color="red">
      </a-cylinder>

      <!-- GUN (Static in front of camera) -->
      <a-box 
        position="0 -0.3 -1" 
        height="0.1" 
        width="0.1" 
        depth="0.8" 
        color="black" 
        static-body>
      </a-box>

      <!-- SHOOTING LASER -->
      <a-entity id="laser" 
                line="start:0 0 0; end:0 0 -2; color: yellow"
                visible="false">
      </a-entity>

      <!-- CAMERA (Player) -->
      <a-entity camera look-controls wasd-controls id="player"></a-entity>

      <!-- SHOOTING SCRIPT -->
      <script>
        document.addEventListener("click", () => {
          const player = document.querySelector("#player");
          const laser = document.querySelector("#laser");

          // Show laser beam
          laser.setAttribute("visible", "true");
          laser.setAttribute("position", player.getAttribute("position"));
          
          // Hide laser after 150ms
          setTimeout(() => {
            laser.setAttribute("visible", "false");
          }, 150);

          // Hit detection
          document.querySelectorAll(".enemy").forEach(enemy => {
            const enemyPos = enemy.object3D.position;
            const playerPos = player.object3D.position;

            const dist = playerPos.distanceTo(enemyPos);
            if (dist < 5) {
              enemy.setAttribute("color", "gray"); // enemy down
            }
          });
        });
      </script>

    </a-scene>
  </body>
</html>
